# fibonacci parallel  processing

## main source   

```  
module Main where
import qualified Parallel as P
main = P.parallel_main
```  

## haskell source    
Paralle.hs

```
module Parallel where
import Control.Exception
import Control.Parallel
import Control.Parallel.Strategies
import Data.Time.Clock
import System.Environment
import Text.Printf

fib2 :: (Eq a1, Num a2, Num a1) => a1 -> [a2]
fib2 1 = 1 : []
fib2 2 = 1 : 1 : []
fib2 n = sum (take 2 f) : f
  where f = fib2 (n - 1)

fib3 :: (Eq a1, Num a, Num a1) => a1 -> a
fib3 n = fib2 n !! 0

-- slow fibonacci
fib :: Integer -> Integer
fib 0 = 1
fib 1 = 1
fib n = fib (n - 1) + fib (n - 2)

printNumber :: Show a => [a] -> IO ()
printNumber [] = return ()
printNumber (x : xs)
  = do putStrLn $ show x
       printNumber xs
```

```
parallel_main :: IO ()
parallel_main
  = do let test = test_fast
       t0 <- getCurrentTime
       r <- evaluate $ runEval test
       printTimeSince t0
       printNumber r
       printTimeSince t0

test_fast
  = do x <- rpar $ fib3 1000
       y <- rpar $ fib3 2000
       z <- rpar $ fib3 3000
       z1 <- rpar $ fib3 4000
       return [x, y, z, z1]

printTimeSince :: UTCTime -> IO ()
printTimeSince t0
  = do t1 <- getCurrentTime
       let v = (realToFrac $ diffUTCTime t1 t0) :: Double
       printf "time: %.9fs seconds\n" v
```


## result   

```
code>stack run
time: 0.000001200s seconds
43466557686937456435688527675040625802564660517371780402481729089536555417949051890403879840079255169295922593080322634775209689623239873322471161642996440906533187938298969649928516003704476137795166849228875
```

```
4224696333392304878706725602341482782579852840250681098010280137314308584370130707224123599639141511088446087538909603607640194711643596029271983312598737326253555802606991585915229492453904998722256795316982874482472992263901833716778060607011615497886719879858311468870876264597369086722884023654422295243347964480139515349562972087652656069529806499841977448720155612802665404554171717881930324025204312082516817125
```

```
410615886307971260333568378719267105220125108637369252408885430926905584274113403731330491660850044560830036835706942274588569362145476502674373045446852160486606292497360503469773453733196887405847255290082049086907512622059054542195889758031109222670849274793859539133318371244795543147611073276240066737934085191731810993201706776838934766764778739502174470268627820918553842225858306408301661862900358266857238210235802504351951472997919676524004784236376453347268364152648346245840573214241419937917242918602639810097866942392015404620153818671425739835074851396421139982713640679581178458198658692285968043243656709796000
```

```
39909473435004422792081248094960912600792570982820257852628876326523051818641373433549136769424132442293969306537520118273879628025443235370362250955435654171592897966790864814458223141914272590897468472180370639695334449662650312874735560926298246249404168309064214351044459077749425236777660809226095151852052781352975449482565838369809183771787439660825140502824343131911711296392457138867486593923544177893735428602238212249156564631452507658603400012003685322984838488962351492632577755354452904049241294565662519417235020049873873878602731379207893212335423484873469083054556329894167262818692599815209582517277965059068235543139459375028276851221435815957374273143824422909416395375178739268544368126894240979135322176080374780998010657710775625856041594078495411724236560242597759185543824798332467919613598667003025993715274875
time: 0.004743900s seconds
code>
```
